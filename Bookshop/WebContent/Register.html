<!DOCTYPE html>
<html>
<head>
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="-1"> 
<meta charset="UTF-8">
<title>Login</title>
<link rel="stylesheet" href="css/style.css">
<script src="./Signup.js"></script>
<SCRIPT type="text/javascript">
		
			var xmlHttp;
			function createXMLHttpRequest() {
				if (window.ActiveXObject) {
					xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
				}
				else if (window.XMLHttpRequest) {
					xmlHttp = new XMLHttpRequest();
				}
			}
			
			function validate() {
				createXMLHttpRequest();
				var username = document.getElementById("username");
				var url = "CheckUserAvailibility?username=" + escape(username.value);
				console.log(escape(username.value));
				xmlHttp.open("GET", url, true);
				 
				xmlHttp.onreadystatechange = handler;
				
				xmlHttp.send(null);
			}
			
			function eMailValidate(){
				createXMLHttpRequest();
				var email = document.getElementById("email");
				var url = "CheckUserAvailibility?email=" + escape(email.value);
				console.log(escape(email.value));
				xmlHttp.open("GET", url, true);
				 
				xmlHttp.onreadystatechange = eMailHandler;
				
				xmlHttp.send(null);
			}
			
				function handler() {
				  if(xmlHttp.readyState == 4 && xmlHttp.status == 200) {
				      var json = eval("(" + xmlHttp.responseText +")");
				      if (json.message == "1")
				      {
				    	  
				    	  
						var mess = "Username available";
				    	 setMessage(mess, "true");	 	    	  
				      }
				      else if(json.message == "0")
				      {
				    	 
				    	  var mess = "The username is taken";
				    	 setMessage(mess, "false"); 
				      }
				      
				  }else if (xmlHttp.readyState == 4 && xmlHttp.status != 200) {
				    alert('Something went wrong...');
				  }
				}
				
				function eMailHandler(){
					if(xmlHttp.readyState == 4 && xmlHttp.status == 200) {
					      var json = eval("(" + xmlHttp.responseText +")");
					   //  alert(json.message);
					      if (json.message == "1")
					      {
					    	 // alert("Email doesnt exists");
							var mess = "Email available";
					    	 setMessageEmail(mess, "true");	 	    	  
					      }
					      else if(json.message == "0")
					      {
					    	 // alert("Email Taken");
					    	  var mess = "The Email is taken";
					    	 setMessageEmail(mess, "false"); 
					      }
					      
					  }else if (xmlHttp.readyState == 4 && xmlHttp.status != 200) {
					    alert('Something went wrong...');
					  }
				}
				
				function setMessage(message, isValid) {
					var messageArea = document.getElementById("numMessage");
					var fontColor="red";
					if (isValid == "true") {
						fontColor = "green";
					}
					messageArea.innerHTML = "<font color=" + fontColor + ">"+ message + " </font>";
				}
				
				function setMessageEmail(message,isEmail) {
					var messageArea = document.getElementById("EmailValidate");
					var fontColor="red";
					if (isEmail == "true") {
						fontColor = "green";
					}
					messageArea.innerHTML = "<font color=" + fontColor + ">"+ message + " </font>";
				}
				
				function validate_password(){
					//alert("hello");
					var pwd = document.getElementById("login_password").value;
					var cpwd = document.getElementById("login_confirm_password").value;
					//alert(pwd);
					//alert(cpwd);
					if (pwd != cpwd){
						var mess = "Passwords do not match"
						var MessArea = document.getElementById("password_error");
						MessArea.innerHTML = "<font color=red>"+ mess+ " </font>";
						document.getElementById("final_submit").disabled = true;
					}
					else{
						var mess = "Passwords match"
						var MessArea = document.getElementById("password_error");
						MessArea.innerHTML = "<font color=green>"+ mess + " </font>";
						document.getElementById("final_submit").disabled = false;
					}
				}
		</SCRIPT>

</head>

<body class="align">

	<div class="site__container">

		<div class="grid__container">

			<form action="#" method="post" class="form form--login" name="signupForm">

				<div class="form__field">
					<label class="fontawesome-user" for="login__username"><span
						class="hidden">Username</span></label> <input
						type="text" class="form__input" placeholder="Username" required
						name="username" id="username" onblur="validate()">
						
				</div>
				<div id="numMessage"></div>
				<div class="form__field">
					<label class="fontawesome-lock" for="login__password"><span
						class="hidden">Password</span></label> <input 
						type="password" class="form__input" placeholder="Password"
						required name="password" id="password">
				</div>
				
				<div class="form__field">
					<label class="fontawesome-user" for="login__fname"><span
						class="hidden">FirstName</span></label> <input 
						type="text" class="form__input" placeholder="First Name" required
						name="fname" id="fname">
				</div>
				<div class="form__field">
					<label class="fontawesome-user" for="login__lname"><span
						class="hidden">LastName</span></label> <input 
						type="text" class="form__input" placeholder="Last Name" required
						name="lname" id="lname">
				</div>
				<div class="form__field">
					<label class="fontawesome-user" for="login__email"><span
						class="hidden">Email</span></label> <input 
						type="text" class="form__input" placeholder="Email" required
						name="email" id="email" onblur="eMailValidate()">
				</div>
				<div id="EmailValidate"></div>
				<div class="form__field">
					<label class="fontawesome-user" for="login__mobile"><span
						class="hidden">Mobile</span></label> <input 
						type="text" class="form__input" placeholder="Mobile" required
						name="mobile" id="mobile">
				</div>
				<div class="form__field">
					<label class="fontawesome-user" for="login__lname"><span
						class="hidden">Adress</span></label> <input 
						type="text" class="form__input" placeholder="Address" required
						name="address" id="address">
				</div>
				<div class="form__field">
					<input type="submit" onclick="submitDetails()" value="Register">
				</div>

			</form>

			
		</div>

	</div>


</body>






</html>
